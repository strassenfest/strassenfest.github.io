var data = [
    {
        id: `a-algemene-broadcast`,
        nederlands: {
            titel: `Ga in de ALGEMENE BROADCAST`,
            beschrijving: `Dat is <a href="https://t.me/+-1BG92MkKMk2ODc0">dit telegramkanaal</a> met de titel "Stop Sub #12".`,
            toelichting: `Voor veel acties, en ook voor deze <span class="a-12">A12-actie</span>, is er een grote <em>signal of telegram-groep</em> waar belangrijke mededelingen worden gepost.`,
        },
        engels: {
            titel: `Join the GENERAL BROADCAST`,
            beschrijving: `It's <a href="https://t.me/+-1BG92MkKMk2ODc0">this telegram group</a> with the title "Stop Sub #12".`,
            toelichting: `For most actions, there is a big broadcast channel where important announcement are made. Always join them, and read the information carefully.`,
        }
    },
    {
        id: `a-vingergroep`,
        nederlands: {
            titel: `Ga in de VINGERGROEP`,
            beschrijving: `Dat is de signal groep waar je als het goed is al in zit. Als dat niet zo is, vul dan snel <a href="https://cryptpad.organise.earth/form/#/2/form/view/B7RPn5C8rcNiXVlWx58yvbsU0c2Li7ZukhOyuGpre88/">dit formulier</a> in!`,
            toelichting: `Bij grote acties wordt er soms gewerkt met 'vingers': dat zijn groepen die samen voorbereiden en naar de actielocatie lopen. Dit vergroot de veiligheid en de kans dat zo veel mogelijk rebellen op de actie aankomen.`,
        },
        engels: {
            titel: `Join the FINGER GROUP`,
            beschrijving: `It is the signal-group that you probably are in already. If not, please quickly fill in <a href="https://cryptpad.organise.earth/form/#/2/form/view/B7RPn5C8rcNiXVlWx58yvbsU0c2Li7ZukhOyuGpre88/">this form</a> and join a finger!`,
            toelichting: `Larger actions sometimes use 'fingers'. These are groups that prepare for the action together and move towards the place of action together. This increases security and our chances of succes.`,
        }
    },
    {
        id: `a-actieconsensus`,
        nederlands: {
            titel: `Lees de ACTIECONSENSUS`,
            beschrijving: `Dit is heel belangrijk. Lees de actie consensus zorgvuldig. Als je het ergens niet mee eens ben, GA DAN NIET MEE. <a href="https://cloud.extinctionrebellion.nl/index.php/s/4WWr9DeXaQamSCJ">Je kunt het hier lezen.</a>`,
            toelichting: `De actie consensus bevat de basis van alle voorwaarden die we hebben afgesproken als Extinction Rebellion. `,
        },
        engels: {
            titel: `Read the ACTION CONSESUS`,
            beschrijving: `This is very important. Read the action consensus carefully. If you don't agree, DON'T JOIN. <a href="https://cloud.extinctionrebellion.nl/index.php/s/4WWr9DeXaQamSCJ">You can read it here</a>`,
            toelichting: `The Action Consensus contains all the conditions we agreed upon as Extinction Rebellion.`,
        }
    },
    {
        id: `a-actietraining`,
        nederlands: {
            titel: `Volg een ACTIETRAINING`,
            beschrijving: `<a href="https://extinctionrebellion.nl/events/?organizer&category=Actietraining">Hier staat een overzicht</a> van alle actietrainingen die nog gegeven worden.`,
            toelichting: `Dit heet ook wel een "non violent direct action training". Als je dat al eerder hebt gedaan, hoeft dat niet nogmaals. Maar als je nieuw bent, is een actietraining heel belangrijk.`,
        },
        engels: {
            titel: `Do an ACTION TRAINING`,
            beschrijving: `<a href="https://extinctionrebellion.nl/events/?organizer&category=Actietraining">Here is an overview</a> of all the trainings being organised.`,
            toelichting: `This is also called a "Non Violent Direct Action training". If you've done one before, you don't need to do it again. However, if this is your first action, this training is very important and you shouldn't join if you haven't participated in one.`,
        }
    },
    {
        id: `a-legal-handout`,
        nederlands: {
            titel: `Lees de LEGAL HANDHOUT`,
            beschrijving: `De legal handout <a href="https://cloud.extinctionrebellion.nl/index.php/s/H5BJkpPJTwkEgkM">staat hier</a>.`,
            toelichting: `Hierin staan antwoorden op vragen zoals: Wat zijn de legale consequenties? Wanneer bel ik een advocaat? Betekent dit iets voor mijn strafblad?`,
        },
        engels: {
            titel: `Read the LEGAL HANDOUT`,
            beschrijving: `The legal handout <a href="https://cloud.extinctionrebellion.nl/index.php/s/H5BJkpPJTwkEgkM">can be read here</a>.`,
            toelichting: `This handout answers questions like: What are the legal consequenses? When do I call a laywer?`,
        }
    },
    {
        id: `a-risico-niveau`,
        nederlands: {
            titel: `Bepaal: HIGH RISK of LOW RISK`,
            beschrijving: `Twijfel je? Bespreek de voor- en nadelen met anderen.`,
            toelichting: `Het is prettig om een "Plan A" te hebben. Zodat je weet wat je wil, ook in hectische situaties.<br/>Bij low risk zeg je: "ik ga weg als de politie vordert". De kans dat je gearresteerd wordt, is dan heel klein.`,
        },
        engels: {
            titel: `Commit: HIGH RISK or LOW RISK`,
            beschrijving: `You can discuss this with others if you're still on the fence. If you don't know what this means, ask your finger!`,
            toelichting: `We always recommend you have a clear plan. If you make that decision early, you won't be confronted by it in a stressful and hectic situation.`,
        }
    },
    {
        id: `a-anonimiteit`,
        nederlands: {
            titel: `Bepaal: ANONIEM of niet?`,
            beschrijving: `Er zijn diverse voor- en nadelen dus laat je vooral goed informeren. Voor meer information, vraag je mede rebellen en je vinger coordinator in je vinger.`,
            toelichting: `Als je anoniem gaat, neem dan ook geen spullen mee met jou naam er op. Dus ook geen bankpas of OV-chipkaart op naam.`,
        },
        engels: {
            titel: `Commit: HIGH RISK or LOW RISK`,
            beschrijving: `There are various pros and cons for anonymity, so inform yourself well. For more information, ask the other rebels and your finger coordinator in your finger group.`,
            toelichting: `If you go anonymous, don't bring any stuff with your name on it. That also means no banking or OV cards.`,
        }
    },
    {
        id: `a-algemene-briefing`,
        nederlands: {
            titel: `Volg de ALGEMENE BRIEFING`,
            beschrijving: `Dit is een online zoom-meeting en duurt een uur.<br/>Engels: di 23 mei 20:30. Nederlands: wo 24 mei 20:30. Een zoom-link volgt op de dag zelf, via de <em>algemene broadcast</em>.`,
            toelichting: `De algemene briefing geeft een laatste update en herhaalt de belangrijkste punten. Het is een zoom-meeting met honderden deelnemers, dus er is niet veel ruimte voor vragen.`,
        },
        engels: {
            titel: `Follow the GENERAL BRIEFINGS`,
            beschrijving: `There will be a general zoom-meeting which will take about an hour.<br/><b>The English briefing is 23rd of may at 20:30</b>.<br/>A zoom link will be shared in the broadcast channel`,
            toelichting: `The general briefing provides the most recent updates and repeats the most import points. It's huge zoom meeting, so there's not a lot of time for questions. If you have remaining questions, you can always ask them in your finger group.`,
        }
    },
    {
        id: `a-vingerbriefing`,
        nederlands: {
            titel: `Volg de VINGERBRIEFING`,
            beschrijving: `In de signal groep van je vinger wordt er gedeeld of er ook nog een aparte vinger briefing zal worden gehouden. Houd de groep in de gaten en doe hieraan mee!`,
            toelichting: `In deze briefing bespreken we het plan voor onze vinger, waaronder de verzamellocatie en aanlooproute. Bovendien is er tijd voor vragen, en kunnen er nog buddies gemaakt worden.`,
        },
        engels: {
            titel: `Join the FINGER BRIEFING`,
            beschrijving: `In the signal group of your finger, the date and time of the finger briefing will be shared. Please join this briefing for your specific meeting location and more information.`,
            toelichting: `In this briefing more specific information about your finger and where to meet will be shared. Also, this is place to get a buddy for the action and there is time for questions`,
        }
    },
    {
        id: `a-rst-nummer`,
        nederlands: {
            titel: `Trek een RST-NUMMER`,
            beschrijving: `Je kunt <a href="https://0527.pidgeyxr.repl.co/">hier</a> een RST nummer opvragen. Dat nummer is jouw arrestanten-nummer of RST ("arrestee")-nummer. Doe dit altijd, ook als je low-risk gaat.`,
            toelichting: `Het RST-nummmer dat je hebt getrokken moet je in het RST formulier invullen. Trek maar 1 keer een nummer en onthoud deze goed!`,
        },
        engels: {
            titel: `Get and RST-NUMBER`,
            beschrijving: `You can draw a RST number <a href="https://0527.pidgeyxr.repl.co/">here</a>. This is your individual arrestee number, remember it carefully and use it in the RST form. Always get one, also if you're low-risk.`,
            toelichting: `The RST number is used to connect you anonymously to who you are. Only RST support knows who is associated with what number, and will delete this information afterwards. `,
        }
    },
    {
        id: `a-rst-form`,
        nederlands: {
            titel: `Vul het RST formulier in!`,
            beschrijving: `Het RST formulier is <a href="https://xrb.link/x79SQU006Fl">hier te vinden</a>. Vul deze zo snel mogelijk in! Deze informatie wordt ook gebruikt om je helpen en te zorgen dat iedereen veilig blijft`,
            toelichting: `Je RST-nummer zorgt er voor dat arrestee-support jou kan traceren. Zo weten ze of er nog rebellen vast zitten. Achter de schermen werkt RST-support er hard aan om iedereen weer vrij te krijgen. Alle RST informatie is <a href="https://xrb.link/yP3yN6">hier te vinden</a>`,
        },
        engels: {
            titel: `Fill in the RST-form!`,
            beschrijving: `You can find the RST-form <a href="https://xrb.link/x79SQU006Fl">here</a>. Submit this form as soon as you can. This information is used to keep you secure and safe.`,
            toelichting: `The rst information is used to trace you during the action. In this way RST support knows if people are still being detained. RST support is working very hard to get you out and support you! All RST information can be checked <a href="https://xrb.link/yP3yN6">here</a>`,
        }
    },
    {
        id: `a-tas-inpakken`,
        nederlands: {
            titel: `Pak je TAS in`,
            beschrijving: `Een paklijst wordt gedeeld tijdens de <em>algemene briefing</em>. <a href="https://strassenfest.github.io/packlist">Hier is een link naar de (straks interactieve) paklijst.</a>`,
            toelichting: `Denk in elk geval aan: warme kleren, eten, drinken, geld, ID-kaart*, OV-kaart*. Géén dierbare bezittingen. Géén wapens, géén drugs.<br/>* niet als je anoniem gaat`,
        },
        engels: {
            titel: `Pack your BAG!`,
            beschrijving: `A packing list will be shared during the general briefing. <a href="https://strassenfest.github.io/packlist">Here is a link to the (soon to be interactive) packing list</a>`,
            toelichting: `Make sure you at least have enough warm clothing, food and water to support yourself for the day. Don't take any alcohol, drugs or things that are very precious to you.`,
        }
    },
    {
        id: `a-plan-treinreis`,
        nederlands: {
            titel: `Plan je (TREIN)REIS`,
            beschrijving: `Een reisadvies volgt.`,
            toelichting: `Houd rekening met eventuele vertragingen. Reis in kleine groepjes.`,
        },
        engels: {
            titel: `Plan your JOURNEY`,
            beschrijving: `Most fingers will share some travel advice`,
            toelichting: `Some delays might happen with public transport, take those into account! Try to travel in small groups.`,
        }
    },
    {
        id: `a-watervaste-stift`,
        nederlands: {
            titel: `Schrijf dit op je LICHAAM`,
            beschrijving: `Schrijf met <em>watervaste stift</em> twee dingen duidelijk op je lichaam:<br/>1. naam van de advocaat.<br/>2. Je RST-nummer.`,
            toelichting: `De naam van de advocaat wordt later bekendgemaakt.`,
        },
        engels: {
            titel: `Write this on your BODY`,
            beschrijving: `Use a permanent marker to write these two things on your body:<br/>1. Name of your lawyer.<br/>2. Your RST-Number`,
            toelichting: `The name of your laywer will be shared in your finger or on the RST-form`,
        }
    },
    {
        id: `a-zen`,
        nederlands: {
            titel: `Je bent er KLAAR voor!`,
            beschrijving: `Neem nog wat rust. Bedenk waarom je het ook alweer doet. We hebben een goed verhaal, we zijn met z'n duizenden. Misschien vind je het spannend. Maar het wordt ook heel gaaf.`,
            toelichting: `Tot snel :)`,
        },
        engels: {
            titel: `You are READY to go!`,
            beschrijving: `Take a deep breath, remember why you are doing this. We're doing this for an important cause, and we're getting more support everyday. Try to also have fun!`,
            toelichting: `We'll see you soon!`,
        }
    },
]

function start() {
    let actiepunten = document.getElementById("actiepunten");

    actiepunten.innerHTML = ""; // bye

    let n = data.length;

    var e = document.getElementById("taalvoorkeur");
    var value = e.value;


    if (value == 'nederlands') {
        for (let i = 0; i < n; i++) {
            var html = template_actiepunt(data[i].id, data[i].nederlands.titel, data[i].nederlands.beschrijving, data[i].nederlands.toelichting);
            actiepunten.insertAdjacentHTML("beforeend", html);

            if (i != n - 1) {
                actiepunten.insertAdjacentHTML("beforeend", template_pijl());
            }
        }
    } else {
        for (let i = 0; i < n; i++) {
            var html = template_actiepunt(data[i].id, data[i].engels.titel, data[i].engels.beschrijving, data[i].engels.toelichting);
            actiepunten.insertAdjacentHTML("beforeend", html);

            if (i != n - 1) {
                actiepunten.insertAdjacentHTML("beforeend", template_pijl());
            }
        }
    }
}

function update() {
    let items = document.getElementsByClassName("actiepunt");

    let is_visible = true;
    let i = 0;

    for (let item of items) {

        let is_checked = item.querySelector(".checkbox").checked;

        // Show or hide the element.
        if (is_visible) {
            item.classList.remove("hidden");
            item.getElementsByClassName("checkbox")[0].disabled = false;
            if (is_checked) {
                item.classList.add("done");
            }
            else {
                item.classList.remove("done");
            }
        }
        else {
            item.classList.add("hidden");
            item.getElementsByClassName("checkbox")[0].disabled = true;

            item.classList.remove("done");
        }

        // When we meet an unchecked item, disable visibility for all next items.

        // I've disabled this for now, so people can cross things off, non-sequential.
        // if (!is_checked)
        // {
        //     is_visible = false;
        // }

        i++;
    };
}

function clear() {
    let items = document.getElementsByClassName("actiepunt");

    for (let item of items) {
        checkbox = item.querySelector(".checkbox");
        checkbox.checked = false;
    }
}

function reset() {
    clear();
    save_to_cookies();

    start();
    update();

    document.documentElement.scrollTop = 0;
}

function save_to_cookies() {
    let items = document.getElementsByClassName("actiepunt");

    for (let item of items) {
        checkbox = item.querySelector(".checkbox");
        let is_checked = checkbox.checked;

        set_cookie(String(checkbox.id), String(is_checked));
    }
}

function load_from_cookies() {
    let items = document.getElementsByClassName("actiepunt");

    for (let item of items) {
        checkbox = item.querySelector(".checkbox");

        let v = get_cookie(checkbox.id);

        if (v == String(true)) {
            checkbox.checked = true;
        }
        else {
            checkbox.checked = false;
        }
    }
}

// Simply copy-pasting this from w3schools:

function set_cookie(cname, cvalue) {
    let days = 40;
    const d = new Date();
    d.setTime(d.getTime() + (days * 24 * 60 * 60 * 1000));
    let expires = "expires=" + d.toUTCString();
    document.cookie = cname + "=" + cvalue + ";" + expires + ";path=/";
}

function get_cookie(cname) {
    let name = cname + "=";
    let decodedCookie = decodeURIComponent(document.cookie);
    let ca = decodedCookie.split(';');
    for (let i = 0; i < ca.length; i++) {
        let c = ca[i];
        while (c.charAt(0) == ' ') {
            c = c.substring(1);
        }
        if (c.indexOf(name) == 0) {
            return c.substring(name.length, c.length);
        }
    }
    return "";
}

function template_actiepunt(id, titel, beschrijving, toelichting) {
    return `
        <div class="actiepunt" id=${id}>
            <div class="box">
            <p class="titel titelfont">${titel}</p>
            <p class="beschrijving">${beschrijving}</p>
            <div class="check">
                <input class="checkbox" type="checkbox" id="${id}" onchange="save_to_cookies(); update()">
                <label class="titelfont" for="${id}">Check</label>
            </div>
            </div>
            <div class="inklapbaar">
            <div class="box toevoeging">
                <p class="toelichting">${toelichting}</p>
            </div>
            </div>
        </div>`
}



function template_pijl() {
    return `
        <img class="pijl" src="img/arrow_down_thin_120.png">`
}


window.addEventListener('load', function () {
    start();
    load_from_cookies();
    update();
})
